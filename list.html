<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
    <title>商品列表</title>
    <link rel="stylesheet" href="css/public.css" type="text/css" />
    <link rel="stylesheet" href="css/style_list.css" type="text/css" />
    <link rel="stylesheet" href="css/pagination.css" type="text/css" />
</head>

<body>
<header>
    <div class="margin t1">
        <div class="header-l">
            <span>吱，欢迎来到次元仓</span>
            <div class="login-register">
                <a href="./login.html">请登录</a>
                <a href="./register.html">免费注册</a>
            </div>
        </div>
        <div class="header-r">
            <a href="#">我的订单</a>
            <a href="./car.html" target="_blank"><img src="images/car.png" /><span>购物车</span><b>0</b></a>
            <a href="#">收藏夹</a>
            <a href="#">联系客服</a>
            <a href="#" class="weibo"><em></em><span class="fText">加关注</span></a>
        </div>
    </div>
</header>

<section id="top">
    <div class="margin">
        <a href="index.html" class="top-l"><img src="images/logo.png"></a>
        <div class="top-c">
            <form action="index.php" method="get" target="_blank" id="search">
                <input type="text" name="q" value="" id="search_key">
                <input type="submit" name="" value="搜&nbsp;索">
                <select name="page_type" class="search_type" style="height:34px; ">
                    <option value="1" selected="selected">商品</option>
                    <option value="2">店铺</option>
                </select>
            </form>
            <ul class="xialalan" id="xialalan" style="display: none;"></ul>
            <div class="guanjianci">
                <a href="#" title="lolita">lolita</a>
                <a href="#" title="Honest">Honest</a>
                <a href="#" title="人">人</a>
                <a href="#" title="画影">画影</a>
                <a href="#" title="风荷举">风荷举</a>
                <a href="#" title="剑三">剑三</a>
                <a href="#" title="举">举</a>
                <a href="#" title="鹤归">鹤归</a>
                <a href="#" title="烟昔泠">烟昔泠</a>
                <a href="#" title="鲛人歌">鲛人歌</a>
                <a href="#" title="风荷">风荷</a>
            </div>
        </div>
        <a href="http://cycang.com/act.php?c=appDownload" class="top-r" target="_blank">
			<img src="images/qr.png" alt="" target="_blank">
			<p style="text-align: center;">下载手机次元仓</p>
		</a>
    </div>
</section>
<nav id="list">
    <div class="margin">
        <a href="index.html" target="_blank">首页</a>
        <a href="list.html" target="_blank">图书仓</a>
        <a href="list.html" target="_blank">汉风仓</a>
        <a href="list.html" target="_blank">手办仓</a>
        <a href="list.html" target="_blank">首饰仓</a>
        <a href="list.html" target="_blank">零食仓</a>
        <a href="list.html" target="_blank">文具仓</a>
        <a href="list.html" target="_blank">古风仓</a>
        <a href="list.html" target="_blank">装扮仓</a>
        <a href="list.html" target="_blank">周边仓</a>
        <a href="list.html" target="_blank">服饰仓</a>
    </div>
</nav>
<section id="main-list">
    <div class="margin">
        <ul>
            <!-- <li><a href="information.html" target="_blank">
                    <img src="http://f.p.cycangcdn.com/1565947994655.jpg" />
                    <p class="product_name">我家大师兄脑子有坑四周年纪念徽章</p>
                    <p class="prduct_price">¥40.00</p>
                </a>
            </li> -->
        </ul>
        <div id="Pagination" class="pagination"></div>
    </div>
</section>

<footer>
    <div class="margin">
        <div class="bottom">
            <dl>
                <dt>商务合作</dt>
                <dd><a href="index.php?a=cooper" target="_blank">品牌进驻</a></dd>
                <dd><a href="index.php?a=cooper" target="_blank">IP授权</a></dd>
                <dd><a href="index.php?a=cooper" target="_blank">批发代销</a></dd>
                <dd><a href="index.php?a=cooper" target="_blank">票务合作</a></dd>
            </dl>
            <dl>
                <dt>联系方式</dt>
                <dd>官方邮箱：act@cycang.com</dd>
                <dd>推广合作：act@cycang.com</dd>
                <dd>媒体合作：act@cycang.com</dd>
                <dd>商务合作：cycswb@126.com</dd>
            </dl>
            <dl>
                <dt>客服售后</dt>
                <dd>客服热线：400-667-1673</dd>
                <dd>客服QQ1：3112573893</dd>
                <dd>客服QQ2：2627466500</dd>
            </dl>
            <dl>
                <dt>直播合作</dt>
                <dd>QQ：2201959143</dd>
            </dl>
            <dl class="dl-te">
                <dt>友情链接：</dt>
                <dd>
                    <a href="http://www.meng2u.com" target="_blank">麦萌对手戏</a>
                </dd>
                <dd>
                    <a href="https://www.bearead.com/" target="_blank">白熊阅读</a>
                </dd>
                <dd>
                    <a href="http://www.icartoons.cn/portal/index.html" target="_blank">爱动漫</a>
                </dd>
            </dl>
            <ul class="bottom-right">
                <li>
                    <a href="//cycang.com/act.php?c=appDownload" target="_blank">
                        <img class="c_qr" src="images/qr.png" alt="">
                        <p class="c_red_light">下载手机次元仓</p>
                    </a>
                </li>
            </ul>
        </div>
    </div>
    <p class="p">
        ICP © 2017 广州脑动网络科技有限公司 版权所有 <a href="#"> 免责声明</a>（备案号：<a href="http://www.miitbeian.gov.cn/publish/query/indexFirst.action" target="_blank">粤ICP备15028368号</a>)
    </p>
</footer>

</body>
<script src="js/ajax.2.0.js"></script>
<script src="js/jquery.js"></script> 
<script src="js/jquery.pagination.js"></script>
<!-- <script src="js/json.list.js"></script>   -->
<script>

$(function(){

var pag = new Pagination();
pag.init();

})

function Pagination(){
this.json = null;
this.index = 0;
this.showNum = 8;
}

Pagination.prototype.init = function(showNum){
if(showNum){
    this.showNum = showNum;
}
if(this.json == null){  //获取数据; (如果没有数据才去获取);
    var that = this;
    $.ajax("http://localhost/ciyuancang/data/goods.json")
    .then(function(res){
        if(typeof res != "object"){
            throw "获取数据失败";
        }
        that.json = res;
        console.log(that.json);
        that.usePagination();//使用pagination;
        that.renderingpage();//渲染页面；
    })
}else{
     this.usePagination();
     this.renderingpage()
}
}
Pagination.prototype.usePagination = function(){
var that = this;
var num = Math.ceil(this.json.length / this.showNum);
$("#Pagination").pagination(num,{
    items_per_page:1,
    next_text:"下一页",
    prev_text:"上一页",
    callback:function(index){
        that.index = index;
        that.renderingpage()
    }
})

}

Pagination.prototype.renderingpage = function(){
var html = "";
var that = this;
$.each(this.json,function(index,obj){
    if(index >= that.index * that.showNum  && index < (that.index+1) * that.showNum){
        html += `<li class="goods" index="${obj.goodsId}">
                            <a href="information.html" target="_blank">
                            <img src="${obj.url}" />
                            <p class="product_name">${obj.name}</p>
                            <p class="prduct_price">￥${obj.price}</p>
                            </a>
                        </li>`

    }
})
$("#main-list ul").html(html);
var that = this;

$("#main-list ul").bind("click",function(eve){
        var e = eve || window.event;
        var target = e.target || e.srcElement;
        console.log(target);
        if(target.parentNode.parentNode.className == "goods"){
            console.log(2);
            // 2.提前找到点击商品的唯一的id
            that.id = target.parentNode.parentNode.getAttribute("index");
            console.log(that.id);
            // 3.准备存储localstorage
            this.onlyId = [];

            this.onlyId.push({
                id:that.id,
            })
            localStorage.setItem("onlyId",JSON.stringify(this.onlyId));
        }
    })
}

</script>
</html>